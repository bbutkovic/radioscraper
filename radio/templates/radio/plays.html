{% extends "ui/base.html" %}

{% load static %}

{% block title %}Plays{% endblock %}

{% block script %}
<script src="{% static 'plays.min.js' %}" type="text/javascript"></script>
{% endblock %}

{% block content %}
<div class="grid-container">
    <form class="search-plays-form" action=".">
        <div class="grid-x">
            <div class="small-12 large-6 cell">

                <!-- Pick date range -->
                <div class="input-group time-span">
                    <span class="input-group-label">Date</span>
                    <input class="input-group-field" type="text" name="start" placeholder="Start" value="{{ start|date:'d.m.Y' }}" />
                    <input class="input-group-field" type="text" name="end" placeholder="End" value="{{ end|date:'d.m.Y' }}" />
                    <div class="input-group-button">
                        <button data-clear-field="start,end" class="button">&times;</button>
                    </div>
                </div>

                <!-- Pick radio -->
                <div class="input-group">
                    <span class="input-group-label">Radio</span>
                    <select data-radio-select name="radio" class="input-group-field">
                        <option value=""{% if not radio %} selected{% endif %}>--- All ---</option>
                        {% for r in radios %}
                            <option value="{{ r.slug }}" {% if r.slug == radio %}selected{% endif %}>
                                {{ r.name }}
                            </option>
                        {% endfor %}
                    </select>
                    <div class="input-group-button">
                        <button data-clear-field="radio" class="button">&times;</button>
                    </div>
                </div>

                <!-- Search artist -->
                <div class="input-group">
                    <span class="input-group-label">Artist</span>
                    <input name="artist_name" class="input-group-field" type="text" value="{{ artist_name|default:"" }}" placeholder="Search by artist">
                    <div class="input-group-button">
                        <button data-clear-field="artist_name" class="button">&times;</button>
                    </div>
                </div>

                <!-- Search title -->
                <div class="input-group">
                    <span class="input-group-label">Title</span>
                    <input name="title" class="input-group-field" type="text" value="{{ title|default:"" }}" placeholder="Search by title">
                    <div class="input-group-button">
                        <button data-clear-field="title" class="button">&times;</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="button-group">
            <button class="button" type="submit">Search</button>
            <button class="button" data-clear-all>Clear</button>
        </div>
    </form>

    {% if plays %}
    <table class="hover">
        <tr>
            <th>Time</th>
            <th>Radio</th>
            <th>Artist</th>
            <th>Title</th>
        </tr>
        {% for play in plays %}
        <tr>
            <td class="no-wrap">
                {{ play.timestamp|date:"d.m.Y @ H:i" }}
            </td>
            <td class="no-wrap">
                <a data-radio="{{ play.radio.slug }}" href="#">{{ play.radio.name }}</a>
            </td>
            <td>
                <a data-artist="{{ play.artist_name }}" href="#">{{ play.artist_name }}</a>
            </td>
            <td>
                <a data-title="{{ play.title }}" href="#">{{ play.title }}</a>
            </td>
        </tr>
        {% endfor %}
    </table>
    {% else %}
    <h5>No plays matching given search parameters found.</h5>
    {% endif %}

    {% include "radio/partial/paging.html" %}
</div>
{% endblock %}
