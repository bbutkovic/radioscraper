{% extends "radio/base.html" %}

{% load static %}

{% block title %}Plays{% endblock %}

{% block after_title %}
    {% if radio %}// {{ radio.name }}{% endif %}
{% endblock %}

{% block script %}
<script src="{% static 'plays.js' %}" type="text/javascript"></script>
{% endblock %}

{% block content %}
<div class="row column">
    <form class="search-plays-form" action=".">
        <div class="row">
            <div class="small-12 medium-6 columns">
                <div class="input-group">
                    <span class="input-group-label">Radio</span>
                    <select data-radio-select name="radio" class="input-group-field">
                        <option value=""{% if not radio %} selected{% endif %}>--- All ---</option>
                        {% for r in radios %}
                            <option value="{{ r.slug }}" {% if r == radio %}selected{% endif %}>
                                {{ r.name }}
                            </option>
                        {% endfor %}
                    </select>
                    <div class="input-group-button">
                        <a href="#" data-clear-radio class="button">&times;</a>
                    </div>
                </div>
                <div class="input-group">
                    <span class="input-group-label">Artist</span>
                    <input name="artist" class="input-group-field" type="text" value="{{ artist|default:"" }}">
                    <div class="input-group-button">
                        <a href="#" data-clear-field="artist" class="button">&times;</a>
                    </div>
                </div>
                <div class="input-group">
                    <span class="input-group-label">Title</span>
                    <input name="title" class="input-group-field" type="text" value="{{ title|default:"" }}">
                    <div class="input-group-button">
                        <a href="#" data-clear-field="title" class="button">&times;</a>
                    </div>
                </div>
            </div>
        </div>
        <div class="button-group">
            <button class="button" type="submit">Search</button>
            <button class="button" data-clear-all>Clear</button>
        </div>
    </form>

    {% if plays %}
    <table class="hover">
        <tr>
            <th>Time</th>
            <th>Radio</th>
            <th>Artist</th>
            <th>Title</th>
        </tr>
        {% for play in plays %}
        <tr>
            <td class="no-wrap">
                {{ play.timestamp|date:"d.m.Y @ H:i" }}
            </td>
            <td class="no-wrap">
                <a data-radio="{{ play.radio.slug }}" href="#">{{ play.radio.name }}</a>
            </td>
            <td>
                <a data-artist="{{ play.artist }}" href="#">{{ play.artist }}</a>
            </td>
            <td>
                <a data-title="{{ play.title }}" href="#">{{ play.title }}</a>
            </td>
        </tr>
        {% endfor %}
    </table>
    {% else %}
    <h5>No plays matching given search parameters found.</h5>
    {% endif %}

    {% include "radio/partial/paging.html" %}
</div>
{% endblock %}
