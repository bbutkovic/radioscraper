{% extends "ui/base.html" %}

{% load radio %}

{% block title %}Home{% endblock %}

{% block content %}
<div id="index-page" class="grid-container">
    <h1>Radio scraper</h1>

    <p>Collecting radio playlists for no particular reason.</p>

    <p>
        <a href="{% url 'radio:plays' %}">List plays</a> Â·
        <a href="{% url 'radio:stats' %}">Statistics</a>
    </p>

    <div class="grid-x grid-margin-x small-up-1 medium-up-2 large-up-4" data-equalizer>
        {% for radio in radios %}
        <div class="cell">
            <div class="radio" data-radio-link="{{ radio.slug }}" data-equalizer-watch>
                <h5>{{ radio.name }}</h5>
                <p>
                    {{ radio.play_count|human_format }} plays
                    {% if radio.first_play.timestamp %}
                    <br />
                    since {{ radio.first_play.timestamp|date:"Y-m-d" }}
                    {% endif %}
                </p>

                {% if radio.last_play %}
                <p>
                    Last play: <br />
                    <b>{{ radio.last_play.title }}</b>
                    by <b>{{ radio.last_play.artist_name }}</b><br />
                    at <i class="gray">{{ radio.last_play.timestamp|date:"Y-m-d @ H:i" }}</i>
                </p>
                {% endif %}
            </div>
            {% with outage=radio.get_current_outage %}
            {% if outage %}
                <div class="outage" title="Failed loading songs for this radio.">
                    Out since:
                    {{ outage.start|date:"Y-m-d @ H:i" }}
                </div>
            {% endif %}
            {% endwith %}
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}
